<h1 class="ui center aligned header">Spam Caller Database</h1>


{{#if search}}
<div class="ui one column stackable center aligned page grid">
   <div class="column twelve wide">
	<h2 class="ui center aligned large header">Search a Phone Number: </h3>
	<div class="ui center input"><input type="text" id="phonenum" placeholder="Type a number..." />
	</div>
	<div class="ui animated list" id="search-container"></div>
	<script>
		var numbers = {{{search}}};
		console.log(numbers.length);
		$('#phonenum').on("keyup",function(){
			$("#search-container").empty();
			var num = $('#phonenum').val();
			var temp = [];
			console.log("Phome num: "+ num);
			if (num.length > 0 ){
				for (var i = 0; i < numbers.length; i++) {
					var curr = numbers[i];
					if (curr.includes(num)) {
						console.log("Curr: "+ curr);
						temp.push(curr);
					} 
				}
			}
			console.log("temp length: " + temp.length);
			if (temp.length > 0) {
				// $('#search-container').append("<div class='ui list'>");
				temp.forEach(function(t){
					$('#search-container').append("<div class='item'><a href='/number/"+t+"'>"+t+"</a></div>");
				});
				// $('#search-container').append("</div>");
			} else {
				$('#search-container').append("<p>No results found!</p>");
			}
		});
	</script>
{{else}}
	<p>Something went wrong</p>
{{/if}}
 </div>
</div>

<div id="allnumstable">
{{#if numbers}}
	<table class="ui fixed single line celled table">
		<thead><tr>
			<th>Phone Number</th>
			<th>Spam Type</th>
			<th>Call Contents</th>
			<th>Number of Reports</th>
			<th>How to Unsubscribe</th>
		</tr></thead>
	{{#each numbers}}
		<tr>
		<td><a href="/number/{{this.phonenum}}">{{this.phonenum}}</a></td>
		<td>{{this.calltype}}</td>
		<td>{{this.callcontent}}</td>
		<td>{{this.reports}}</td>
		<td>{{this.howtounsub}}</td>
		</tr>
	{{/each}}
	</table>
{{else}}
	<h1 class="ui center aligned header">No spam numbers reported yet!</h1>
{{/if}}
</div>